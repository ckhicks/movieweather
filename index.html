<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title></title>
<style>
</style>
</head>
<body>
<button>Fetch</button>
<div></div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>
jQuery(document).ready(function () {
  $('button').click(e => {
    $('div').html('Fetching your location...');
    setTimeout(() => {
      navigator.geolocation.getCurrentPosition(
        function success(pos) {
          $('div').html('Finding movies...');
          let coords = pos.coords;
          $.get(`https://wt-2dbbcf5bf5af5b6e970f518f3e2755ee-0.run.webtask.io/movie-weather?lat=${coords.latitude}&lng=${coords.longitude}`, res => {
            $('div').html('Matching...');
            setTimeout(() => {
              $('div').html(`
                <strong>Weather: ${res[0].summary}, ${(res[0].apparentTemperature).toFixed()}&deg;</strong><br>
                <strong>Genre 1: ${res[2][0]}</strong><br>
                <strong>Film 1: ${res[1][0].title}</strong><br>
                <img src="https://image.tmdb.org/t/p/w500/${res[1][0].poster_path}"><br>
                <strong>Genre 2: ${res[2][1]}</strong><br>
                <strong>Film 2: ${res[1][1].title}</strong><br>
                <img src="https://image.tmdb.org/t/p/w500/${res[1][1].poster_path}"><br>
              `);
            }, 1000);
          });
        },
        null,
        options = {
          enableHighAccuracy: true,
          timeout: 5000,
          maximumAge: 0
        }
      );
    }, 500);
  });
});
</script>
</body>
</html>